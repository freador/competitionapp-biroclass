<section class="mx-auto max-w-2xl space-y-8">
  <header class="text-center">
    <p class="text-xs uppercase tracking-[0.4em] text-indigo-400">Convite recebido</p>
    <h1 class="mt-2 text-3xl font-semibold text-slate-900"><%= @competition.title %></h1>
    <p class="mt-2 text-slate-500">Você foi convidado para participar como <strong class="text-slate-900"><%= @invitable.is_a?(CompetitionJudge) ? "jurado" : "participante" %></strong>.</p>
  </header>

  <article class="rounded-3xl border border-slate-100 bg-white/95 p-8 shadow-xl">
    <div class="space-y-4 text-sm text-slate-600">
      <p><strong>Organizador:</strong> <%= @competition.owner.name %></p>
      <% if @invitable.respond_to?(:email) && @invitable.email.present? %>
        <p><strong>Email do convite:</strong> <%= @invitable.email %></p>
      <% end %>
      <p class="text-slate-500">Aceite o convite para acessar o dashboard privado e enviar notas.</p>
    </div>

    <% if user_signed_in? %>
      <div class="mt-6 rounded-2xl border border-indigo-100 bg-indigo-50 px-5 py-4 text-sm text-indigo-900">
        Conectado como <strong><%= current_user.email %></strong>.
      </div>
      <%= button_to "Aceitar convite", invite_path(token: params[:token]), method: :patch, class: "mt-4 w-full rounded-full bg-indigo-600 px-4 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow-lg shadow-indigo-500/30 transition hover:bg-indigo-500" %>
    <% else %>
      <%= form_with model: @user, url: invite_path(token: params[:token]), method: :patch, class: "mt-6 space-y-4" do |form| %>
        <% if @user.errors.any? %>
          <div class="rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-800">
            <%= @user.errors.full_messages.to_sentence %>
          </div>
        <% end %>
        <div>
          <%= form.label :name, "Nome completo", class: "text-sm font-semibold text-slate-700" %>
          <%= form.text_field :name, required: true, class: "mt-2 w-full rounded-2xl border border-slate-200 px-4 py-2.5 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200" %>
        </div>
        <div>
          <%= form.label :email, class: "text-sm font-semibold text-slate-700" %>
          <%= form.email_field :email, required: true, class: "mt-2 w-full rounded-2xl border border-slate-200 px-4 py-2.5 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200" %>
        </div>
        <div>
          <%= form.label :password, class: "text-sm font-semibold text-slate-700" %>
          <%= form.password_field :password, required: true, class: "mt-2 w-full rounded-2xl border border-slate-200 px-4 py-2.5 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200" %>
        </div>
        <div>
          <%= form.label :password_confirmation, class: "text-sm font-semibold text-slate-700" %>
          <%= form.password_field :password_confirmation, required: true, class: "mt-2 w-full rounded-2xl border border-slate-200 px-4 py-2.5 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200" %>
        </div>
        <%= form.submit "Criar conta e aceitar", class: "w-full rounded-full bg-indigo-600 px-4 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow-lg shadow-indigo-500/30 transition hover:bg-indigo-500" %>
      <% end %>
      <p class="mt-4 text-center text-xs uppercase tracking-[0.3em] text-slate-400">Já possui conta? Entre e abra este mesmo link.</p>
    <% end %>
  </article>
</section>
