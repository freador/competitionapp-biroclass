<% content_for :title, @participant.name %>

<%= render "shared/page_header",
    title: @participant.name,
    breadcrumb: "Detalhes do participante" %>

<div class="mt-8 space-y-6">
  <!-- Participant Details Card -->
  <article class="rounded-3xl border border-slate-100 bg-white p-6 shadow-xl">
    <div class="flex items-start gap-6">
      <div class="flex h-20 w-20 items-center justify-center rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white shadow-xl">
        <svg class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <use href="#heroicon-users" />
        </svg>
      </div>

      <div class="flex-1 space-y-4">
        <div>
          <h2 class="text-3xl font-bold text-slate-900"><%= @participant.name %></h2>
        </div>

        <div class="grid gap-4 md:grid-cols-2">
          <% if @participant.competition.present? %>
            <div class="rounded-2xl border border-slate-100 bg-slate-50/60 p-4">
              <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 mb-2">Competição</p>
              <p class="text-lg font-semibold text-slate-900"><%= @participant.competition.title %></p>
              <%= link_to "Ver competição", competition_path(@participant.competition), class: "mt-2 inline-flex items-center gap-1 text-xs font-semibold text-indigo-600 hover:text-indigo-500 transition-colors" do %>
                <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <use href="#heroicon-arrow-right" />
                </svg>
                Acessar
              <% end %>
            </div>
          <% end %>

          <% if @participant.user.present? %>
            <div class="rounded-2xl border border-slate-100 bg-slate-50/60 p-4">
              <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 mb-2">Jurado Responsável</p>
              <p class="text-lg font-semibold text-slate-900"><%= @participant.user.name %></p>
              <p class="text-sm text-slate-500"><%= @participant.user.email %></p>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="mt-6 flex flex-wrap gap-3 pt-6 border-t border-slate-200">
      <%= link_to edit_participant_path(@participant), class: "inline-flex items-center gap-2 rounded-full border border-slate-300 px-5 py-2.5 text-xs font-semibold uppercase tracking-wide text-slate-700 transition-all duration-200 hover:bg-slate-50 hover:border-slate-400 active:scale-95" do %>
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <use href="#heroicon-pencil" />
        </svg>
        Editar participante
      <% end %>
      <%= link_to participants_path, class: "inline-flex items-center gap-2 rounded-full border border-slate-300 px-5 py-2.5 text-xs font-semibold uppercase tracking-wide text-slate-700 transition-all duration-200 hover:bg-slate-50 hover:border-slate-400 active:scale-95" do %>
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <use href="#heroicon-arrow-right" />
        </svg>
        Voltar para lista
      <% end %>
      <%= button_to participant_path(@participant), method: :delete, form: { data: { turbo_confirm: "Tem certeza que deseja excluir este participante?" } }, class: "inline-flex items-center gap-2 rounded-full border border-rose-200 bg-rose-50 px-5 py-2.5 text-xs font-semibold uppercase tracking-wide text-rose-600 transition-all duration-200 hover:bg-rose-100 hover:border-rose-300 active:scale-95" do %>
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <use href="#heroicon-trash" />
        </svg>
        Excluir participante
      <% end %>
    </div>
  </article>

  <!-- Rankings Section -->
  <% if @participant.rankings.any? %>
    <article class="rounded-3xl border border-slate-100 bg-white p-6 shadow-xl">
      <header class="flex items-center justify-between mb-6">
        <div>
          <p class="text-xs uppercase tracking-[0.3em] text-indigo-400">Avaliações</p>
          <h2 class="text-2xl font-semibold text-slate-900">Rankings Recebidos</h2>
        </div>
        <span class="rounded-full bg-indigo-50 px-3 py-1 text-xs font-semibold text-indigo-600">
          <%= @participant.rankings.count %>
        </span>
      </header>

      <div class="space-y-3">
        <% @participant.rankings.order(created_at: :desc).each do |ranking| %>
          <div class="rounded-2xl border border-slate-100 bg-slate-50/60 p-4 transition-all duration-200 hover:shadow-md hover:border-slate-200">
            <div class="flex items-center justify-between">
              <div class="flex-1">
                <p class="text-sm font-semibold text-slate-900">
                  Avaliado por <%= ranking.user.name %>
                </p>
                <p class="text-xs text-slate-500">
                  <%= l ranking.created_at, format: :short %>
                </p>
                <% if ranking.notes.present? %>
                  <p class="mt-2 text-sm text-slate-600"><%= ranking.notes %></p>
                <% end %>
              </div>
              <div class="text-right">
                <p class="text-3xl font-bold text-indigo-600"><%= ranking.score %></p>
                <p class="text-xs text-slate-500">pontos</p>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </article>
  <% end %>
</div>
