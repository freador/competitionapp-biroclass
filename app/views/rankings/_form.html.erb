<%= form_with(model: ranking, class: "space-y-6") do |form| %>
  <% if ranking.errors.any? %>
    <div class="rounded-2xl border border-rose-200 bg-rose-50 p-4" role="alert">
      <div class="flex items-center gap-2 mb-2">
        <svg class="h-5 w-5 text-rose-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <use href="#heroicon-x" />
        </svg>
        <h3 class="text-sm font-semibold text-rose-900">
          <%= pluralize(ranking.errors.count, "erro") %> impediu que esta avaliação fosse salva:
        </h3>
      </div>
      <ul class="ml-7 list-disc space-y-1 text-sm text-rose-700">
        <% ranking.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="rounded-3xl border border-slate-100 bg-white p-6 shadow-xl">
    <div class="space-y-5">
      <%= render "shared/form_field",
          form: form,
          field: :participant_id,
          label: "Participante",
          type: "select",
          required: true,
          options: Participant.all.map { |p| ["#{p.name} (#{p.competition.title})", p.id] },
          include_blank: "Selecione um participante",
          help_text: "Escolha o participante que será avaliado" %>

      <%= render "shared/form_field",
          form: form,
          field: :competition_id,
          label: "Competição",
          type: "select",
          required: true,
          options: Competition.all.map { |c| [c.title, c.id] },
          include_blank: "Selecione uma competição",
          help_text: "Competição à qual esta avaliação pertence" %>

      <%= render "shared/form_field",
          form: form,
          field: :total_score,
          label: "Pontuação Total",
          type: "number",
          required: true,
          placeholder: "100",
          help_text: "Digite a pontuação obtida pelo participante" %>

      <%= render "shared/form_field",
          form: form,
          field: :position,
          label: "Posição no Ranking (opcional)",
          type: "number",
          placeholder: "1",
          help_text: "Posição do participante na classificação final" %>
    </div>

    <div class="mt-6 flex flex-wrap gap-3 pt-6 border-t border-slate-200">
      <%= form.submit (ranking.new_record? ? "Criar Avaliação" : "Atualizar Avaliação"), class: "inline-flex items-center gap-2 rounded-full bg-indigo-600 px-6 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow-lg shadow-indigo-500/30 transition-all duration-200 hover:bg-indigo-500 hover:shadow-xl active:scale-95" %>

      <%= link_to "Cancelar", (ranking.new_record? ? rankings_path : ranking_path(ranking)), class: "inline-flex items-center gap-2 rounded-full border border-slate-300 px-6 py-3 text-sm font-semibold uppercase tracking-wide text-slate-700 transition-all duration-200 hover:bg-slate-50 hover:border-slate-400 active:scale-95" %>
    </div>
  </div>
<% end %>
