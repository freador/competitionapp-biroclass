<% content_for :title, "Meu Perfil" %>

<div class="mx-auto max-w-7xl space-y-10 px-6 py-10">
  <!-- Profile Header -->
  <header class="rounded-2xl border-4 border-black bg-white p-10 shadow-2xl">
    <p class="font-['Montserrat'] text-xs font-bold uppercase tracking-[0.3em] text-gray-600">Configurações de conta</p>
    <h1 class="mt-3 font-['Montserrat'] text-6xl font-bold text-black">Meu Perfil</h1>
  </header>

  <!-- Profile Card -->
  <article class="rounded-2xl border-4 border-black bg-white p-10 shadow-2xl">
    <div class="flex flex-col gap-8 md:flex-row md:items-start">
      <!-- Avatar -->
      <div class="flex h-32 w-32 flex-shrink-0 items-center justify-center rounded-full border-4 border-black bg-[#FFCC00] shadow-2xl">
        <span class="font-['Montserrat'] text-7xl font-bold text-black"><%= @user.name[0].upcase %></span>
      </div>

      <!-- User Info -->
      <div class="flex-1 space-y-6">
        <div>
          <h2 class="font-['Montserrat'] text-5xl font-bold text-black"><%= @user.name %></h2>
          <p class="mt-2 text-2xl text-gray-600"><%= @user.email %></p>
        </div>

        <!-- Role Badge -->
        <div class="flex flex-wrap gap-3">
          <% if @user.role.present? %>
            <% role_variant = case @user.role
                when "admin" then "primary"
                when "judge", "jurado" then "info"
                else "default"
              end %>
            <%= render "shared/badge", text: @user.role.titleize, variant: role_variant, size: "lg" %>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="mt-10 flex flex-wrap gap-3 border-t-2 border-gray-200 pt-8">
      <%= link_to edit_profile_path, class: "inline-flex items-center gap-2 rounded-full bg-[#FFCC00] px-6 py-3 font-['Montserrat'] text-xs font-bold uppercase tracking-wide text-black shadow-lg shadow-[#FFCC00]/20 transition-all hover:scale-105 hover:bg-[#FFD633] active:scale-95" do %>
        <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor">
          <use href="#heroicon-pencil" />
        </svg>
        Atualizar perfil
      <% end %>
      <%= link_to competitions_path, class: "inline-flex items-center gap-2 rounded-full border-2 border-gray-400 px-6 py-3 font-['Montserrat'] text-xs font-bold uppercase tracking-wide text-gray-700 transition-all hover:border-black hover:bg-gray-50 active:scale-95" do %>
        <svg class="h-5 w-5 rotate-180" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor">
          <use href="#heroicon-arrow-right" />
        </svg>
        Voltar para competições
      <% end %>
    </div>
  </article>

  <!-- Stats Grid -->
  <div class="grid gap-8 md:grid-cols-2">
    <!-- Owned Competitions -->
    <% if @user.owned_competitions.any? %>
      <article class="rounded-2xl border-4 border-black bg-white p-10 shadow-2xl">
        <header class="mb-8 flex items-center justify-between">
          <div>
            <p class="font-['Montserrat'] text-xs font-bold uppercase tracking-[0.3em] text-[#FFCC00]">Organizador</p>
            <h2 class="mt-2 font-['Montserrat'] text-3xl font-bold text-black">Competições Criadas</h2>
          </div>
          <span class="rounded-full border-2 border-[#FFCC00] bg-[#FFCC00]/10 px-5 py-2 font-['Montserrat'] text-lg font-bold text-[#FFCC00]">
            <%= @user.owned_competitions.count %>
          </span>
        </header>
        <div class="space-y-3">
          <% @user.owned_competitions.limit(5).each do |competition| %>
            <%= link_to competition_path(competition), class: "block rounded-xl border-2 border-gray-200 bg-gray-50 p-5 transition-all hover:border-[#FFCC00] hover:shadow-md" do %>
              <p class="font-['Montserrat'] text-xl font-bold text-black"><%= competition.title %></p>
              <p class="mt-2 text-sm text-gray-600">
                <span class="font-bold text-black"><%= competition.participants.count %></span> participantes
              </p>
            <% end %>
          <% end %>
        </div>
      </article>
    <% end %>

    <!-- Evaluations Made -->
    <% if @user.notes.any? %>
      <article class="rounded-2xl border-4 border-black bg-white p-10 shadow-2xl">
        <header class="mb-8 flex items-center justify-between">
          <div>
            <p class="font-['Montserrat'] text-xs font-bold uppercase tracking-[0.3em] text-[#FFCC00]">Jurado</p>
            <h2 class="mt-2 font-['Montserrat'] text-3xl font-bold text-black">Avaliações Realizadas</h2>
          </div>
          <span class="rounded-full border-2 border-[#FFCC00] bg-[#FFCC00]/10 px-5 py-2 font-['Montserrat'] text-lg font-bold text-[#FFCC00]">
            <%= @user.notes.count %>
          </span>
        </header>
        <div class="space-y-3">
          <% @user.notes.includes(:participant, :competition).limit(5).each do |note| %>
            <div class="rounded-xl border-2 border-gray-200 bg-gray-50 p-5">
              <p class="font-['Montserrat'] text-xl font-bold text-black"><%= note.participant.name %></p>
              <div class="mt-3 flex items-center justify-between">
                <p class="text-sm text-gray-600"><%= note.competition.title %></p>
                <p class="font-['Montserrat'] text-2xl font-bold text-[#FFCC00]"><%= note.score %> pts</p>
              </div>
            </div>
          <% end %>
        </div>
      </article>
    <% end %>
  </div>
</div>
