<% status_options = Competition.statuses.keys.map { |status| [status.titleize, status] } %>

<%= form_with(model: competition, class: "space-y-6") do |form| %>
  <% if competition.errors.any? %>
    <div class="rounded-2xl border border-rose-200 bg-rose-50 p-4" role="alert">
      <div class="flex items-center gap-2 mb-2">
        <svg class="h-5 w-5 text-rose-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <use href="#heroicon-x" />
        </svg>
        <h3 class="text-sm font-semibold text-rose-900">
          <%= pluralize(competition.errors.count, "erro") %> impediu que esta competição fosse salva:
        </h3>
      </div>
      <ul class="ml-7 list-disc space-y-1 text-sm text-rose-700">
        <% competition.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="rounded-2xl border-4 border-black bg-white p-10 shadow-2xl">
    <div class="space-y-5">
      <%= render "shared/form_field",
          form: form,
          field: :title,
          label: "Título da Competição",
          type: "text",
          required: true,
          autofocus: true,
          placeholder: "Ex: Hackathon de Inovação 2024",
          help_text: "Escolha um título claro e descritivo" %>

      <%= render "shared/form_field",
          form: form,
          field: :description,
          label: "Descrição",
          type: "textarea",
          rows: 4,
          placeholder: "Descreva os objetivos e contexto da competição...",
          help_text: "Explique o propósito e contexto da competição" %>

      <%= render "shared/form_field",
          form: form,
          field: :rules,
          label: "Regras da Competição",
          type: "textarea",
          rows: 6,
          placeholder: "1. Cada participante pode submeter até 3 projetos
2. Os projetos devem ser originais
3. Prazo de submissão: 30 dias...",
          help_text: "Defina as regras e critérios de avaliação" %>

      <%= render "shared/form_field",
          form: form,
          field: :status,
          label: "Status da Competição",
          type: "select",
          required: true,
          options: status_options,
          include_blank: "Selecione o status",
          help_text: "Defina o estado atual da competição" %>
    </div>

    <div class="mt-6 flex flex-wrap gap-3 pt-6 border-t-2 border-black">
      <%= form.submit (competition.new_record? ? "Criar Competição" : "Atualizar Competição"), class: "inline-flex items-center gap-2 rounded-full bg-[#FFCC00] px-6 py-3 text-sm font-['Montserrat'] font-semibold uppercase tracking-wide text-black shadow-lg shadow-[#FFCC00]/20 transition-all duration-200 hover:bg-[#FFD633] hover:scale-105 active:scale-95" %>

      <%= link_to "Cancelar", (competition.new_record? ? competitions_path : competition_path(competition)), class: "inline-flex items-center gap-2 rounded-full border-2 border-black px-6 py-3 text-sm font-['Montserrat'] font-semibold uppercase tracking-wide text-black transition-all duration-200 hover:bg-black hover:text-[#FFCC00] active:scale-95" %>
    </div>
  </div>
<% end %>
