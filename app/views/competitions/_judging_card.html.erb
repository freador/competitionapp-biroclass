<% note.participant ||= participant %>
<%= turbo_frame_tag dom_id(participant, :judging_card) do %>
  <article class="h-full rounded-2xl border-4 border-black bg-white p-6 shadow-lg">
    <div class="flex items-start justify-between gap-4">
      <div>
        <p class="text-xs uppercase tracking-[0.3em] font-['Montserrat'] text-[#FFCC00]">Participante</p>
        <h3 class="text-xl font-['Montserrat'] font-semibold text-black"><%= participant.display_name %></h3>
        <% if participant.user&.email.present? %>
          <p class="text-xs text-gray-600"><%= participant.user.email %></p>
        <% end %>
      </div>
      <% if note.persisted? %>
        <span class="rounded-full bg-emerald-500 border-2 border-black px-3 py-1 text-xs font-['Montserrat'] font-semibold text-white">Nota enviada</span>
      <% else %>
        <span class="rounded-full bg-amber-500 border-2 border-black px-3 py-1 text-xs font-['Montserrat'] font-semibold text-white">Pendente</span>
      <% end %>
    </div>

    <div class="mt-4 rounded-2xl border-2 border-black bg-white p-4">
      <%= form_with model: [competition, note], class: "space-y-3" do |form| %>
        <%= form.hidden_field :participant_id, value: participant.id %>
        <div>
          <%= form.label :score, "Nota (0 a 10)", class: "text-sm font-['Montserrat'] font-semibold text-black" %>
          <%= form.number_field :score,
                min: 0,
                max: 10,
                step: 1,
                class: "mt-1 w-full rounded-2xl border-2 border-black px-4 py-2 text-lg font-['Montserrat'] font-semibold text-black focus:border-[#FFCC00] focus:ring-4 focus:ring-[#FFCC00]/20",
                required: true %>
        </div>
        <div>
          <%= form.label :comment, "ComentÃ¡rio (opcional)", class: "text-sm font-['Montserrat'] font-semibold text-black" %>
          <%= form.text_area :comment,
                rows: 3,
                class: "mt-1 w-full rounded-2xl border-2 border-black px-4 py-2 text-sm text-gray-700 focus:border-[#FFCC00] focus:ring-4 focus:ring-[#FFCC00]/20",
                placeholder: "Compartilhe seus feedbacks" %>
        </div>

        <% if note.errors.any? %>
          <div class="rounded-2xl border-2 border-rose-600 bg-rose-50 px-4 py-3 text-sm font-['Montserrat'] font-semibold text-rose-700">
            <%= note.errors.full_messages.to_sentence %>
          </div>
        <% end %>

        <div class="flex items-center justify-between gap-3">
          <% if note.persisted? && note.updated_at.present? %>
            <p class="text-xs text-gray-500">
              Atualizada em <%= l note.updated_at, format: :short %>
            </p>
          <% end %>
          <%= form.submit(note.persisted? ? "Atualizar nota" : "Enviar nota",
                class: "ml-auto inline-flex items-center rounded-full bg-[#FFCC00] px-4 py-2 text-xs font-['Montserrat'] font-semibold uppercase tracking-wide text-black shadow-lg shadow-[#FFCC00]/20 transition hover:bg-[#FFD633] hover:scale-105") %>
        </div>
      <% end %>
    </div>
  </article>
<% end %>
